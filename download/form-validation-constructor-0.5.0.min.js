!function(){"use strict";function debounce(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=void 0;return function(){for(var i=this,a=arguments.length,s=Array(a),o=0;o<a;o++)s[o]=arguments[o];r?clearTimeout(r):n&&e.apply(this,s),r=setTimeout(function(){n||e.apply(i,s),r=0},t)}}function findWarning(e,t){var n=e.name,r=e.type,i=[];return t.length&&t.forEach(function(e){config[r].includes(e)?i.push(e):console.error('Warning: field named "'+n+'" with type="'+r+'". \n\t\t\t\tdata-options can not contain check to "'+e+'"')}),i}function checkValue(e,t){var n=Object.keys(e),r="instructions-"+types.lang;return n.length&&n.forEach(function(n){var i=e[n],a=i.inputElement,s=i.config,o="";s.length&&s.some(function(e){var t=types[e];if(t){if(!t.validate(a))return o=t[r],!0}return!1}),t.set(a,o)}),t}function sortGroups(e){var t=[],n=[],r=[];return e.forEach(function(i){var a=sortForName(i,r);if(!n.includes(a)){var s=selectAllElementsCurrentGroup(a,e,r);n.push(a),t.push(s)}}),t}function selectAllElementsCurrentGroup(e,t,n){var r=[];return t.forEach(function(t){var i=sortForName(t,n);e===i&&r.push(t)}),r}function sortForName(e,t){var n=e.type,r=void 0;if(n===RADIO)r=e.name;else if(n===CHECKBOX){var i=e.dataset.groupname;i?r=i:t.includes(e.name)||(t.push(e.name),console.error("Please enter valid groupname for input with name "+e.name+' \n\t\t\t\t\tand type="checkbox"'))}return r}function checkValueGroup(e,t){var n="instructions-"+types.lang;return e.length&&e.forEach(function(e){var r=getMessage(e,n);t.set(e[0],r)}),t}function getMessage(e,t){var n="";return e.length&&e.some(function(r){var i=types[IS_EMPTY_GROUP];if(i){if(!i.validate(e))return n=i[t],!0}return!1}),n}function validation(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("undefined"==typeof window)return void console.error("Sorry but this library is designed to work in the browser!");var t=document.querySelectorAll("form[data-validation=true]");if(e.lang)types.lang=e.lang;else{var n=document.documentElement.lang;types.lang=n||EN}if(Object.keys(e).length){for(var r in e)!function(t){var n=e[t].typeField,r=e[t].checkName;n&&n.forEach(function(e){return config[e].push(r)})}(r);Object.assign(types,e)}initValidation(t)}function initValidation(e){Array.prototype.forEach.call(e,function(e){return new Validation(e)})}var warnings={en:{isNonEmpty:"This field can not be empty.",onlyLetters:'value can only be the letters "a" to "z".',isValidNumber:"value can only be a number, such as 1, 3.14 or 2010",minMax:"value can only be a number no less and no more than min max",min:"value can only be a number not less than min",max:"value can only be a number not more than max",isEmailCorrect:"enter a valid email",isValidTel:"enter a valid phone",isValidUrl:"enter a valid url",isRequired:"for to continue activate a mandatory field",isEmptyGroup:"you need to select at least one item"},ru:{isNonEmpty:"это поле не может быть пустым.",onlyLetters:'значением может быть только буквы от "а" до "я".',isValidNumber:"значением может быть только число­, например 1, 3.14 или 2010",minMax:"значением может быть только число не меньше min и не больше max",min:"значением может быть только число не меньше min",max:"значением может быть только число не больше max",isEmailCorrect:"введите корректный email",isValidTel:"введите корректный телефон",isValidUrl:"введите корректный url",isRequired:"для продолжения активируйте обязательное поле",isEmptyGroup:"необходимо выбрать хоть один пункт"}},IS_NON_EMPTY="isNonEmpty",ONLY_LETTERS="onlyLetters",IS_VALID_NUMBER="isValidNumber",MIN_MAX="minMax",MIN="min",MAX="max",IS_EMAIL_CORRECT="isEmailCorrect",IS_VALID_TEL="isValidTel",IS_VALID_URL="isValidUrl",IS_REQUIRED="isRequired",IS_EMPTY_GROUP="isEmptyGroup",EN="en",INSTRUCTION_EN="instructions-en",INSTRUCTION_RU="instructions-ru",CLASS_SHOW="show",CLASS_NOTIFY="notify",EVENT_SUBMIT="submit",EVENT_INPUT="input",EVENT_CHANGE="change",RADIO="radio",CHECKBOX="checkbox",classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),defineProperty=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},_isNonEmpty,_onlyLetters,_isValidNumber,_minMax,_min,_max,_isEmailCorrect,_isValidTel,_isValidUrl,_isRequired,_isEmptyGroup,types={isNonEmpty:(_isNonEmpty={validate:function(e){return""!==e.value}},defineProperty(_isNonEmpty,INSTRUCTION_EN,warnings.en.isNonEmpty),defineProperty(_isNonEmpty,INSTRUCTION_RU,warnings.ru.isNonEmpty),_isNonEmpty),onlyLetters:(_onlyLetters={validate:function(e){return!/[^a-zа-яё ]/gi.test(e.value)}},defineProperty(_onlyLetters,INSTRUCTION_EN,warnings.en.onlyLetters),defineProperty(_onlyLetters,INSTRUCTION_RU,warnings.ru.onlyLetters),_onlyLetters),isValidNumber:(_isValidNumber={validate:function(e){return!isNaN(e.value)}},defineProperty(_isValidNumber,INSTRUCTION_EN,warnings.en.isValidNumber),defineProperty(_isValidNumber,INSTRUCTION_RU,warnings.ru.isValidNumber),_isValidNumber),minMax:(_minMax={validate:function(e){var t=Number(e.min),n=Number(e.max),r=Number(e.value);return t>r||r>n}},defineProperty(_minMax,INSTRUCTION_EN,warnings.en.minMax),defineProperty(_minMax,INSTRUCTION_RU,warnings.ru.minMax),_minMax),min:(_min={validate:function(e){return Number(e.min)>Number(e.value)}},defineProperty(_min,INSTRUCTION_EN,warnings.en.min),defineProperty(_min,INSTRUCTION_RU,warnings.ru.min),_min),max:(_max={validate:function(e){var t=Number(e.max);return Number(e.value)>t}},defineProperty(_max,INSTRUCTION_EN,warnings.en.max),defineProperty(_max,INSTRUCTION_RU,warnings.ru.max),_max),isEmailCorrect:(_isEmailCorrect={validate:function(e){return/^.+@.+$/.test(e.value)}},defineProperty(_isEmailCorrect,INSTRUCTION_EN,warnings.en.isEmailCorrect),defineProperty(_isEmailCorrect,INSTRUCTION_RU,warnings.ru.isEmailCorrect),_isEmailCorrect),isValidTel:(_isValidTel={validate:function(e){return!/[^0-9 .()*+-]/g.test(e.value)}},defineProperty(_isValidTel,INSTRUCTION_EN,warnings.en.isValidTel),defineProperty(_isValidTel,INSTRUCTION_RU,warnings.ru.isValidTel),_isValidTel),isValidUrl:(_isValidUrl={validate:function(e){return/^(https?|s?ftp|file):\/\/[a-zа-яё_-]+[\a-zа-яё\.]{2,6}\??([a-zа-яё_-]+)\#?([a-zа-яё_-]+)/g.test(e.value)}},defineProperty(_isValidUrl,INSTRUCTION_EN,warnings.en.isValidUrl),defineProperty(_isValidUrl,INSTRUCTION_RU,warnings.ru.isValidUrl),_isValidUrl),isRequired:(_isRequired={validate:function(e){return e.checked}},defineProperty(_isRequired,INSTRUCTION_EN,warnings.en.isRequired),defineProperty(_isRequired,INSTRUCTION_RU,warnings.ru.isRequired),_isRequired),isEmptyGroup:(_isEmptyGroup={validate:function(e){return e.some(function(e){return e.checked})}},defineProperty(_isEmptyGroup,INSTRUCTION_EN,warnings.en.isEmptyGroup),defineProperty(_isEmptyGroup,INSTRUCTION_RU,warnings.ru.isEmptyGroup),_isEmptyGroup)},config={text:[IS_NON_EMPTY,ONLY_LETTERS],number:[IS_NON_EMPTY,IS_VALID_NUMBER,MIN_MAX,MIN,MAX],email:[IS_NON_EMPTY,IS_EMAIL_CORRECT],password:[IS_NON_EMPTY],file:[IS_NON_EMPTY],search:[IS_NON_EMPTY,ONLY_LETTERS],tel:[IS_NON_EMPTY,IS_VALID_TEL],url:[IS_NON_EMPTY,IS_VALID_URL],checkbox:[IS_REQUIRED,IS_EMPTY_GROUP],radio:[IS_REQUIRED,IS_EMPTY_GROUP]},checkAttrGroup=function(e){return e===IS_EMPTY_GROUP},addedClasses=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.classList.add(n)},removedClasses=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.classList.remove(n)},OutputErrors=function(){function e(){classCallCheck(this,e),this.storeCreateElements=new Map,this.errorNotificationElement=Object.create(null)}return createClass(e,[{key:"sortMessages",value:function(e){var t=this;e.forEach(function(e,n,r){if(e)if(t.storeCreateElements.has(n)){if(t.storeCreateElements.get(n).message!==e){var i=t.storeCreateElements.get(n);i.createdElement.textContent=e,i.message=e,addedClasses(i.createdElement,CLASS_SHOW)}}else t.errorNotificationElement={createdElement:t.createErrorElement(n,e),message:e},t.storeCreateElements.set(n,t.errorNotificationElement);else if(t.storeCreateElements.has(n)){var a=t.storeCreateElements.get(n);a.createdElement.textContent="",a.message="",removedClasses(a.createdElement,CLASS_SHOW)}})}},{key:"createErrorElement",value:function(e,t){var n=document.createElement("span");return addedClasses(n,CLASS_NOTIFY),setTimeout(function(){return addedClasses(n,CLASS_SHOW)}),n.textContent=t,e.parentElement.insertBefore(n,e),n}}]),e}(),Store=function(){function e(){classCallCheck(this,e),this.outputErrors=new OutputErrors}return createClass(e,[{key:"getMessage",value:function(e){this.outMessage(e)}},{key:"outMessage",value:function(e){this.outputErrors.sortMessages(e)}}]),e}(),Validation=function(){function e(t){var n=this;classCallCheck(this,e),this.form=t,this.listInputElement=t.querySelectorAll("\n\t\t\tinput[type=text],\n\t\t\tinput[type=number],\n\t\t\tinput[type=email],\n\t\t\tinput[type=password],\n\t\t\tinput[type=file],\n\t\t\tinput[type=search],\n\t\t\tinput[type=tel],\n\t\t\tinput[type=url],\n\t\t\tinput[type=checkbox],\n\t\t\tinput[type=radio]\n\t\t"),this.store=new Store,this.storeErrors=new Map,this.dataSimpleInput=Object.create(null),this.dataGroupElements=[],this.isFormRegisterHandler=!1,this.boundFormInputHandler=debounce(function(e){return n.validation(e)},100,!0),this.boundFormChangeHandler=debounce(function(e){return n.validation(e)},100,!0),this.registerHandlers()}return createClass(e,[{key:"registerHandlers",value:function(){var e=this;this.init(),this.form.addEventListener(EVENT_SUBMIT,function(t){return e.validation(t)})}},{key:"formRegisterHandlers",value:function(){this.isFormRegisterHandler||(this.form.addEventListener(EVENT_INPUT,this.boundFormInputHandler),this.form.addEventListener(EVENT_CHANGE,this.boundFormChangeHandler),this.isFormRegisterHandler=!0)}},{key:"formUnRegisterHandlers",value:function(){this.form.removeEventListener(EVENT_INPUT,this.boundFormInputHandler),this.form.removeEventListener(EVENT_CHANGE,this.boundFormChangeHandler),this.isFormRegisterHandler=!1}},{key:"init",value:function(){var e=this,t=[];Array.prototype.forEach.call(this.listInputElement,function(n,r){var i=n.dataset.options;if(i){var a=i.split(" ");if(n.type===RADIO||n.type===CHECKBOX){if(a.some(checkAttrGroup))return void t.push(n)}e.dataSimpleInput[r]={inputElement:n,name:n.name,config:findWarning(n,a)}}}),this.dataGroupElements=sortGroups(t)}},{key:"validation",value:function(e){e.preventDefault(),checkValue(this.dataSimpleInput,this.storeErrors),checkValueGroup(this.dataGroupElements,this.storeErrors),this.store.getMessage(this.storeErrors);var t=!0,n=!1,r=void 0;try{for(var i,a=this.storeErrors.values()[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){if(""!==i.value)return void this.formRegisterHandlers()}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}e.type===EVENT_SUBMIT&&(this.formUnRegisterHandlers(),this.form.submit())}}]),e}();validation();}();
