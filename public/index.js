!function(){"use strict";function t(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=void 0;return function(){for(var i=this,o=arguments.length,a=Array(o),u=0;u<o;u++)a[u]=arguments[u];r?clearTimeout(r):n&&t.apply(this,a),r=setTimeout(function(){n||t.apply(i,a),r=0},e)}}function e(t,e){var n=t.name,r=t.type,i=[];return e.forEach(function(t){f[r].indexOf(t)!==-1?i.push(t):console.error('Warning: field named "'+n+'" with type="'+r+'". data-options can not contain check to "'+t+'"')}),i}function n(t,e){for(var n=Object.keys(t).length,r=function(n){var r=t[n],i=r.input,o=r.config,a="instructions-"+r.lang,u="",s=function(t){var e=l[t];if(e){var n=e.validate(i);if(n)return!1;var r=e[a];return u=r,!0}return!1};o&&o.some(s),e.set(i,u)},i=0;i<n;i++)r(i);return e}function r(t){var e=[];t.forEach(function(t){var n=o(t);e.indexOf(n)===-1&&e.push(n)});var n=[];return e.forEach(function(e){var r=i(e,t);n.push(r)}),n}function i(t,e){var n=[];return e.forEach(function(e){var r=o(e);return t===r&&(n.push(e),!0)}),n}function o(t){var e=t.type,n=void 0;if("radio"===e)n=t.name;else if("checkbox"===e){var r=t.dataset.groupname;r&&(n=r)}return n}function a(t,e){return t.forEach(function(t){var n=u(t);e.set(t[0],n)}),e}function u(t){var e="instructions-en",n="",r=function(r){var i=l.isEmptyGroup;if(i){var o=i.validate(t);if(o)return!1;var a=i[e];return n=a,!0}return!1};return t.some(r),n}function s(){var t=document.querySelectorAll("form[data-validation=true]");c(t)}function c(t){Array.prototype.forEach.call(t,function(t){new y(t)})}var l={isNonEmpty:{validate:function(t){return""!==t.value},"instructions-ru":"это поле не может быть пустым.","instructions-en":"This field can not be empty."},onlyLetters:{validate:function(t){return!/[^a-zа-яё ]/gi.test(t.value)},"instructions-ru":'значением может быть только буквы от "а" до "я".',"instructions-en":'value can only be the letters "a" to "z".'},isValidNumber:{validate:function(t){return!isNaN(t.value)},"instructions-ru":"значением может быть только число­, например 1, 3.14 или 2010","instructions-en":"value can only be a number, such as 1, 3.14 or 2010"},minMax:{validate:function(t){var e=Number(t.min),n=Number(t.max),r=Number(t.value);return!(e>r||r>n)},"instructions-ru":"значением может быть только число не меньше min и не больше max","instructions-en":"value can only be a number no less and no more than min max"},min:{validate:function(t){var e=Number(t.min),n=Number(t.value);return!(e>n)},"instructions-ru":"значением может быть только число не меньше min","instructions-en":"value can only be a number not less than min"},max:{validate:function(t){var e=Number(t.max),n=Number(t.value);return!(n>e)},"instructions-ru":"значением может быть только число не больше max","instructions-en":"value can only be a number not more than max"},isEmailCorrect:{validate:function(t){return/^.+@.+$/.test(t.value)},"instructions-ru":"введите корректный email","instructions-en":"enter a valid email"},isValidTel:{validate:function(t){return!/[^0-9 .()*+-]/g.test(t.value)},"instructions-ru":"введите корректный телефон","instructions-en":"enter a valid phone"},isValidUrl:{validate:function(t){return/^(https?|s?ftp|file):\/\/[a-zа-яё_-]+[\a-zа-яё\.]{2,6}\??([a-zа-яё_-]+)\#?([a-zа-яё_-]+)/g.test(t.value)},"instructions-ru":"введите корректный url","instructions-en":"enter a valid url"},isRequired:{validate:function(t){return t.checked},"instructions-ru":"для продолжения активируйте обязательное поле","instructions-en":"for to continue activate a mandatory field"},isEmptyGroup:{validate:function(t){var e=t.some(function(t){return!!t.checked});return e},"instructions-ru":"необходимо выбрать хоть один пункт","instructions-en":"you need to select at least one item"}},f={text:["isNonEmpty","onlyLetters"],number:["isNonEmpty","isValidNumber","minMax","min","max"],email:["isNonEmpty","isEmailCorrect"],password:["isNonEmpty"],file:["isNonEmpty"],search:["isNonEmpty","onlyLetters"],tel:["isNonEmpty","isValidTel"],url:["isNonEmpty","isValidUrl"],checkbox:["isRequired","group"],radio:["isRequired","group"]},m=function(t){return"group"===t},v=(function(){function t(t){this.value=t}function e(e){function n(t,e){return new Promise(function(n,i){var u={key:t,arg:e,resolve:n,reject:i,next:null};a?a=a.next=u:(o=a=u,r(t,e))})}function r(n,o){try{var a=e[n](o),u=a.value;u instanceof t?Promise.resolve(u.value).then(function(t){r("next",t)},function(t){r("throw",t)}):i(a.done?"return":"normal",a.value)}catch(t){i("throw",t)}}function i(t,e){switch(t){case"return":o.resolve({value:e,done:!0});break;case"throw":o.reject(e);break;default:o.resolve({value:e,done:!1})}o=o.next,o?r(o.key,o.arg):a=null}var o,a;this._invoke=n,"function"!=typeof e.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)},{wrap:function(t){return function(){return new e(t.apply(this,arguments))}},await:function(e){return new t(e)}}}(),function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}),p=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),h=function(){function t(){v(this,t),this.storeCreateElements=new Map,this.errorNotificationElement=Object.create(null)}return p(t,[{key:"sortMessages",value:function(t){var e=this,n=t.keys().next().value,r=n.closest("form");t.forEach(function(t,n,r){var i=n,o=t;o?e.storeCreateElements.has(i)?e.storeCreateElements.get(i).message!==o&&(e.storeCreateElements.get(i).newElement.textContent=o,e.storeCreateElements.get(i).message=o):(e.errorNotificationElement={newElement:e.createErrorElement(i,o),message:o},e.storeCreateElements.set(i,e.errorNotificationElement)):e.storeCreateElements.has(i)&&!function(){var t=e.storeCreateElements.get(i).newElement;t.classList.add("hide"),setTimeout(function(){i.parentElement.removeChild(t),e.storeCreateElements.delete(i)},100)}()}),0===this.storeCreateElements.size&&r.submit()}},{key:"createErrorElement",value:function(t,e){var n=document.createElement("span");return n.classList.add("notify"),setTimeout(function(){return n.classList.add("show")},0),n.textContent=e,t.parentElement.insertBefore(n,t),n}}]),t}(),d=function(){function t(){v(this,t),this.outputErrors=new h}return p(t,[{key:"getMessage",value:function(t){this.outMessage(t)}},{key:"outMessage",value:function(t){this.outputErrors.sortMessages(t)}}]),t}(),y=function(){function i(t){v(this,i),this.form=t,this.listInputElement=t.querySelectorAll("input[type=text], input[type=number], input[type=email], input[type=password], input[type=file], \n\t\t\tinput[type=search], input[type=tel], input[type=url], input[type=checkbox], input[type=radio]"),this.store=new d,this.storeErrors=new Map,this.groupsElements=[],this.dataInput=Object.create(null),this.isFirst=!0,this.registerHandlers()}return p(i,[{key:"registerHandlers",value:function(){var t=this;this.init(),this.form.addEventListener("submit",function(e){return t.validation(e)})}},{key:"init",value:function(){var t=this,n=document.documentElement.lang,i=[],o=[];Array.prototype.filter.call(this.listInputElement,function(t){var n=t.dataset.options;if(n){if("radio"===t.type||"checkbox"===t.type){var r=n.split(" "),a=(e(t,r),r.some(m));return a?(o.push(t),!0):(i.push(t),!1)}return i.push(t),!1}}),this.groupsElements=r(o),i.forEach(function(r,i){var o=r.dataset.options,a=void 0;if(o){var u=o.split(" ");a=e(r,u)}t.dataInput[i]={input:r,name:r.name,config:a,lang:n}})}},{key:"validation",value:function(e){var r=this;e.preventDefault();var i=n(this.dataInput,this.storeErrors);i=a(this.groupsElements,this.storeErrors),this.store.getMessage(i),this.isFirst&&(this.form.addEventListener("input",t(function(t){return r.validation(t)},100,!0)),this.form.addEventListener("change",t(function(t){return r.validation(t)},100,!0)),this.isFirst=!1)}}]),i}();s()}();
